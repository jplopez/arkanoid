pico-8 cartridge // http://www.pico-8.com
version 42
__lua__

#include globals.lua

#include entities/class.lua
#include entities/paddle.lua
#include entities/ball.lua
#include entities/brick.lua
#include entities/level.lua

#include utilities/timers.lua
#include utilities/utils.lua
#include utilities/log.lua

#include states/init.lua
#include states/start.lua
#include states/game.lua
#include states/gameover.lua
#include states/levelup.lua
#include states/bonus.lua

#include utilities/timers.lua
#include utilities/utils.lua
#include utilities/log.lua

#include handlers/event.lua
#include handlers/ball_loose_event.lua
#include handlers/collisions/ball_paddle_event.lua
#include handlers/collisions/brick_ball_event.lua

-------------
--game loop
-------------

function _init()
  cls()
  init_players()
  init_objects()
  log("init level " .. _players["p1"]["level"])
end

-- called every frame
function _update60()
  log("begin update60 level " .. _players["p1"]["level"])
  log("begin update60 state " .. _state)

  if (_state == "start") update_start()
  if (_state == "game") update_game()
  if (_state == "gameover") update_gameover()
  if (_state == "levelup") update_levelup()

  log("end update60 level " .. _players["p1"]["level"])
  log("end update60 state " .. _state)

end

-- called every frame
function _draw()
  if (_state == "start") draw_start()
  if (_state == "game") draw_game()
  if (_state == "gameover") draw_gameover()
  if (_state == "levelup") draw_levelup()
end

-- for reasons beyond my understanding
-- this include only works when placed
-- after the game loop functions
#include entities/col_eng.lua

-->8

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000900090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700009600960000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000060000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006888600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
4801000019320173201532013320123201032010320103201132015320173201e3201f32000300003000030000300003000030000300003000030000300013000130000300003000030000300003000030000300
000000001002112021140211600117001180311b0311e031230312a0312d031300313103126001250012500131001350013300132001000010000101001020010100100001000010100100001000010000100001
48020000123101331002700293202e3203032014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
000200001954215542135420e54207542005420a5420c5420f5421254215542185421a5421c5421d5421f5422354225542285422b5422e5423054232542345423554236542395423a5423b5423b5423a5423b542
000400001e0501f0501f0501e0501b0501805014050120500f0500d0500905007050040500205001050000500005000050070000c0000e0000c00008000050000400002000020000200002000020000000000000
60020000123101331002700293202e3203032014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
1901000033710377103871039730397300e7000e7000c7000b7003a7003c700077000070000700007000070000700007000070000700007000070000700007000070000700007000070000700007000070000700
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010200000e3100f310027001a3201d3202a32014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
010200000f31010310027001e320233203032014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
010200001031011310027001c3201e3203332014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
010200001131012310027001d3201f320343503b3003a3003c3000730000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000000000000
010200001231013310027001e320203203532014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
010200001331014310027001e320213203732014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
0102000014310153100270020320223203932014300383003b3003a3003c300073000030000300003000030000300003000030000300003000030000300003000030000300003000030000300003000030000300
